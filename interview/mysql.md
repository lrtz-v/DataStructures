# mysql

## 索引

- 最左前缀
  - 检索数据时从联合索引的最左边开始匹配
  - 配合索引下推

## 锁

- InnoDB 的锁

  - 库锁：对全库加锁，让整个库处于只读状态
    - 使用场景
      - 全库逻辑备份
  - 表锁：限制表的读写
    - 在还没有出现更细粒度的锁的时候，表锁是最常用的处理并发的方式
  - 表元数据锁（MDL）
    - 访问表时，加 MDL 读锁
    - 更改表结构时，加 MDL 写锁， 读写互斥，写写互斥
  - 行读写锁：在需要的时候才加上的，等到事务结束时释放
    - 死锁检测
  - 间隙锁
    - 锁的就是两个值之间的空隙
    - 跟间隙锁存在冲突关系的，是“往这个间隙中插入一个记录”这个操作。间隙锁之间都不存在冲突关系
    - 影响了并发度
  - next-key 锁：间隙锁和行锁合称 next-key lock， 前开后闭区间

- 乐观锁与悲观锁

  - 乐观锁： 适合读取操作比较频繁的场景
    - 使用条件限制
    - 数据表加 version 字段
  - 悲观锁：适合写入操作比较频繁
    - 共享锁
      - 读锁，允许事务读一行数据
    - 排他锁
      - 写锁，允许事务删除或更新一行数据

- binlog

- redo log

- crash safe

- 分布式事务
